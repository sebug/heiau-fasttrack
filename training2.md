# Trivadis Performance Days 2021 Day 2
Basics: https://docs.oracle.com/en/database/oracle/oracle-database/19/tgsql/index.html

My biggest fear: The people before me already got clever.

## Jonathan Lewis - Hinting in all its forms

### Why can't the optimizer find a good plan?
Sample: It can, but it takes too long.

We may also use hints to use the same plan as in production.

Database agnostic code.

Can't change parts of the system.

### How can we avoid hinting

 * Timing
 * Table strategy (-> you could also have a materialized view)
 * Indexing (use index compression)
 * Statistics (you can even fake the statistics)
 * Session parameters / fix controls
 * Code rewrite (if you're lucky and it's your code)
 * SQL Translation / advanced rewrite (but really you shouldn't)

### Hinting Options

- You can numerically correct the estimated number of rows - OPT_ESTIMATE

dba_sql_plan_directives give hints not for query but one table

### Question about the stability of query block names
Yup, they're stable.

#### In the code
They're badly documented and difficult to get right. See v$sql_hint

### When there are 17 tables and tons of predicates
Oracle will have a hard time

### Helpful hints
no_merge leading - figure out this one first

### SQL Patches
For an exact SQL id

dbms_sqldiag.create_sql_patch

### SQL Profiles
Set of hints generated by Tuning Advisor. You can force match (for example, query with id 50, apply for all ids).

## Dani Schnider - Autonomous, Automatic, Adaptive

### Introducing example
Oracle performance specialist - just update to the next Oracle version.

### Evolution
10g - Automatic Statistics Gathering Job during maintenance window

12c - Adaptive Plans and Statistics, Online Statistics Gathering

19c - Real-Time Statistics, High-Frequency Automatic Statistics Collection

### SELECT * FROM Topics WHERE Name LIKE '%Automatic%'

### Automatic Indexing
Use SQL history for typical queries, identify index candidates, create them
as invisible. Verify the captured statements with index candidates, for
each candidate, see whether it improves performance, if yes then set it to
visible.

Decommission unused indexes.

dbms_auto_index.configure and 15 minutes later he already got his indexes.

dbms_auto_index.report_activity()

- Only available on Exadata and Autonomous Databases

### Automatic Materialized Views
Not yet working as expected.

Based on Object Activity Tracking system that you have access to everywhere.

You cannot read from an automatic materialized view, it's just here for query
rewrites.

### You can try out exadata stuff on your sandbox by enabling an undocumented feature.

### Automatic Statistics gathering
Was already available for direct-path inserts in 12c, more general in 19c.

### Adaptive Query Optimizations
Not turned on by default - shaky performance, can't change join order.

### Autonomous
Gotta try out one of these OTP automatic databases.

### The role changes just a bit
Good queries.


